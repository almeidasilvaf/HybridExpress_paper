{
  "hash": "7385050925345ddf2780c82a609eed06",
  "result": {
    "engine": "knitr",
    "markdown": "---\nexecute: \n  echo: true\n  eval: true\n  warning: false\n---\n\n\n# Benchmark 2: transcriptomic analyses of heterosis in rice root traits\n\nHere, we will use __HybridExpress__ on data from @zhai2013transcriptome.\nIn this study, authors sequenced the transcriptomes of the super-hybrid\nrice variety Xieyou 9308 and its parents at tillering and heading\nstages to understand the molecular basis of heterosis (i.e., superior\nperformance of hybrids compared to parents) in root traits.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(here)\nlibrary(HybridExpress)\nlibrary(SummarizedExperiment)\nlibrary(ComplexHeatmap)\nlibrary(tidyverse)\nlibrary(patchwork)\n\nset.seed(123) # for reproducibility\n```\n:::\n\n\n## Data description and experimental design\n\nWe will start by loading the data set, which is stored in \na `SummarizedExperiment` object with a count matrix and sample metadata.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the data\nload(here(\"data\", \"se_rice.rda\"))\n\nse_rice\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass: SummarizedExperiment \ndim: 42081 12 \nmetadata(0):\nassays(1): counts\nrownames(42081): Os01t0100100-01 Os01t0100200-01 ... Os12t0641500-03\n  Os12t0641600-01\nrowData names(0):\ncolnames(12): R1 R2 ... F3 F4\ncolData names(3): Line Stage Generation\n```\n\n\n:::\n\n```{.r .cell-code}\n# Taking a look at the assay\nhead(assay(se_rice))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                 R1  R2  R3  R4  X1  X2  X3  X4  F1  F2  F3  F4\nOs01t0100100-01 397 685 247 332 372 348 489 414 257 420 225 262\nOs01t0100200-01   7  21  14   8   9   2  10  15   3   9   8  12\nOs01t0100400-01  90 195  81  54 141  56 114  91 110 345  52  68\nOs01t0100500-01 436 571 324 315 418 353 509 516 280 371 289 276\nOs01t0100600-01 264 443 191 300 211 249 345 360 215 195 206 162\nOs01t0100650-00  12   3   3   2  12  13  39   2   0   2   0  14\n```\n\n\n:::\n\n```{.r .cell-code}\n# Taking a look at the sample metadata\ncolData(se_rice) |> as.data.frame()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           Line     Stage Generation\nR1        R9308 Tillering         P1\nR2        R9308 Tillering         P1\nR3        R9308   Heading         P1\nR4        R9308   Heading         P1\nX1 Xieqingzao B Tillering         P2\nX2 Xieqingzao B Tillering         P2\nX3 Xieqingzao B   Heading         P2\nX4 Xieqingzao B   Heading         P2\nF1  Xieyou 9308 Tillering         F1\nF2  Xieyou 9308 Tillering         F1\nF3  Xieyou 9308   Heading         F1\nF4  Xieyou 9308   Heading         F1\n```\n\n\n:::\n:::\n\n\nAs we can see in the sample metadata, for each stage (tillering and heading),\ntwo replicates were obtained for each generation (parents and hybrid).\nLine Xieyou 9308 represents the hybrid, while lines R9308 and Xieqingzao B\nrepresent the parents 1 and 2, respectively. Given this experimental design,\nwe will perform comparative analyses separately for each stage. Thus, our\ntriplets will be:\n\n1. R9308 <-> Xieyou 9308 <-> Xieqingzao B, heading stage\n2. R9308 <-> Xieyou 9308 <-> Xieqingzao B, tillering\n\nLet's subset the data accordingly:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get triplets for each stage\nse_h <- se_rice[, se_rice$Stage == \"Heading\"]\nse_t <- se_rice[, se_rice$Stage == \"Tillering\"]\n```\n:::\n\n\n## Data processing\n\nHere, we will first remove non-expressed genes (sum of counts <10 across\nall samples). Then, we will add midparent expression values to each set, and \nnormalize count data by library size.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Remove non-expressed genes\nse_h <- se_h[rowSums(assay(se_h)) >= 10, ]\nse_t <- se_t[rowSums(assay(se_t)) >= 10, ]\n\n# Add midparent expression\nse_h <- add_midparent_expression(se_h)\nse_t <- add_midparent_expression(se_t)\n\n# Normalize data by library size\nse_h <- add_size_factors(se_h)\nse_t <- add_size_factors(se_t)\n```\n:::\n\n\n## Exploratory data analyses\n\nNow, we will perform exploratory data analyses to check if samples group\ntogether as expected. We will first explore sample clustering with PCA plots.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot PCA for each stage separately\np_pca_h <- pca_plot(se_h, color_by = \"Generation\", add_mean = TRUE) + \n    labs(title = \"PCA of samples - Heading stage\")\n\np_pca_t <- pca_plot(se_t, color_by = \"Generation\", add_mean = TRUE) + \n    labs(title = \"PCA of samples - Tillering stage\")\n\n# Combine plots\np_pca_combined <- patchwork::wrap_plots(\n    p_pca_h + theme(legend.position = \"bottom\", legend.box = \"vertical\"), \n    p_pca_t + theme(legend.position = \"bottom\", legend.box = \"vertical\"),\n    nrow = 1\n) +\n    plot_layout(guides = \"collect\") &\n    theme(legend.position = \"bottom\")\n\np_pca_combined\n```\n\n::: {.cell-output-display}\n![](chapter_02_files/figure-html/unnamed-chunk-4-1.png){width=768}\n:::\n:::\n\n\nNow, let's visualize a heatmap of sample correlations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Heatmap of sample correlations\np_hmh <- plot_samplecor(se_h, coldata_cols = \"Generation\", show_rownames = FALSE)\np_hmh@column_title <- \"Heading\"\n\np_hmt <- plot_samplecor(se_t, coldata_cols = \"Generation\", show_rownames = FALSE)\np_hmt@column_title <- \"Tillering\"\n\n# Combine plots - one per row\np_hm_combined <- patchwork::wrap_plots(\n    ggplotify::as.ggplot(p_hmh), \n    ggplotify::as.ggplot(p_hmt), \n    nrow = 2\n)\n\np_hm_combined\n```\n\n::: {.cell-output-display}\n![](chapter_02_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nIn the heading stage, samples group very well by line,\nas demonstrated by both the PCA plot and the heatmap of sample correlations. \nIn the tillering stage, though, there is a lot of within-group variation\nfor the hybrid samples, which is an issue that could probably be mitigated\nby including more replicates. This is something we need to keep in mind\nwhen interpreting results in the following sections.\n\n## Identifying differentially expressed genes in triplets\n\nHere, we will identify differentially expressed genes (DEGs) between\npairwise combinations of lines in a triplet in the heading and tillering\nstages. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get DEGs\ndeg_h <- get_deg_list(se_h, lfcThreshold = 1)\ndeg_t <- get_deg_list(se_t, lfcThreshold = 1)\n```\n:::\n\n\nNext, we will visualize the frequencies of DEGs with an expression triangle.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot expression triangle\np_triangle_h <- get_deg_counts(deg_h) |>\n    plot_expression_triangle(\n        box_labels = c(\"R9308\", \"Xieqingzao B\", \"Xieyou 9308\", \"Midparent\")\n    ) +\n    labs(title = \"Heading\") +\n    theme(plot.title = element_text(hjust = 0.5))\n\np_triangle_t <- get_deg_counts(deg_t) |>\n    plot_expression_triangle(\n        box_labels = c(\"R9308\", \"Xieqingzao B\", \"Xieyou 9308\", \"Midparent\")\n    ) +\n    labs(title = \"Tillering\") +\n    theme(plot.title = element_text(hjust = 0.5))\n\n# Combine plots\np_triangle_all <- wrap_plots(\n    p_triangle_h,\n    p_triangle_t,\n    nrow = 1\n) +\n    plot_annotation(tag_levels = \"A\") &\n    theme(plot.tag = element_text(size = 16))\n\np_triangle_all\n```\n\n::: {.cell-output-display}\n![](chapter_02_files/figure-html/unnamed-chunk-7-1.png){width=4500}\n:::\n:::\n\n\nThe triangle plot shows a clear imbalance in the number of DEGs in the hybrid\nrelative both parents, with much more DEGs relative to the Xieqingzao B line\nin the heading stage, and much more DEGs relative to the R9308 line in the\ntillering stage. This results suggest a developmental stage-mediated shift in\nexpression-level dominance, with a bias towards parent R9308 in the heading\nstage, and a bias towards parent Xieqingzao B in the tillering stage.\nHowever, considering the large within-group variance\nfor hybrid samples in the tillering stage, it is not clear whether such shift\nbias is due to true biological differences or an artifact resulting from \nsuch large variances.\n\n\nNext, to better understand the differences and similarities between stages, \nwe will explore the overlap of DEGs between stages.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a list of DEGs for each contrast and create a combination matrix\ndeg_sets <- list(\n    `R9308, heading` = rownames(deg_h$F1_vs_P1),\n    `Xieqingzao B, heading` = rownames(deg_h$F1_vs_P2),\n    `R9308, tillering` = rownames(deg_t$F1_vs_P1),\n    `Xieqingzao B, tillering` = rownames(deg_t$F1_vs_P2)\n)\nm <- ComplexHeatmap::make_comb_mat(deg_sets)\n\n# Plot UpSet\np_upset <- ComplexHeatmap::UpSet(\n    m,\n    comb_col = ggsci::pal_jama()(7)[comb_degree(m)],\n    top_annotation = upset_top_annotation(m, add_numbers = TRUE),\n    set_order = names(deg_sets)\n)\n\np_upset\n```\n\n::: {.cell-output-display}\n![](chapter_02_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nThe figure shows that, overall, most of the DEGs between the hybrid and parents\nare parent- and stage-specific (e.g., only differentially expressed\nrelative to R9308 in the heading stage). However, we also observed a large \noverlap in DEGs relative to both parents in each stage (N = 286 and 280 for the\nheading and tillering stages, respectively), and a similar but smaller overlap\nexists for DEGs relative to the same parent in different stages (N = 186 and\n217 for lines R9308 and Xieqingziao B, respectively).\n\n\n## Classifying genes into expression groups\n\nTo understand the expression patterns of hybrids relative to their progenitors,\nwe will classify genes onto expression-based categories and classes\nas in @rapp2009genomic.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Classify genes in expression partitions (classes and categories)\npartition_h <- expression_partitioning(deg_h)\npartition_t <- expression_partitioning(deg_t)\n```\n:::\n\n\nNow, let's visualize results:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get frequency of genes per class\np_pfreq_h <- plot_partition_frequencies(partition_h, group_by = \"Class\")\np_pfreq_t <- plot_partition_frequencies(partition_t, group_by = \"Class\")\n\n# Combine plots\np_freq_combined <- wrap_plots(\n    p_pfreq_h[[1]],\n    p_pfreq_h[[2]] + labs(subtitle = \"Heading\", x = NULL), \n    p_pfreq_t[[2]] + labs(subtitle = \"Tillering\", x = NULL), \n    nrow = 1, \n    widths = c(1, 2, 2)\n)\n\np_freq_combined\n```\n\n::: {.cell-output-display}\n![](chapter_02_files/figure-html/unnamed-chunk-10-1.png){width=960}\n:::\n:::\n\n\nThe figure shows that most genes (67.51%) display expression-level dominance \n(ELD) towards parent 1 (R9308 line) in the heading stage, which is in line\nwith what we observed in the expression triangle plot. \nHowever, in the tillering stage, most genes (41.24%) display ELD towards \nparent 2 (Xieqingzao B), but large fractions of the genes also display\nELD towards parent 1 (25.78%) and transgressive down-regulation (26.04%),\nagain suggesting a dramatic shift in expression patterns in temporal scale.\n\n## Overrepresentation analyses\n\nNow, we will perform overrepresentation analyses of GO terms among genes \nin each expression class in each stage.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load GO annotation\nload(here(\"data\", \"rice_functions.rda\"))\nrice_functions <- lapply(rice_functions, as.data.frame)\n\n# Perform ORA\n## Heading\ngenes_h <- split(partition_h$Gene, partition_h$Class)\nora_h <- lapply(\n    genes_h, ora,\n    annotation = bind_rows(rice_functions), \n    background = rownames(se_h),\n    min_setsize = 2, max_setsize = 1000\n)\n\n## Tillering\ngenes_t <- split(partition_t$Gene, partition_t$Class)\nora_t <- lapply(\n    genes_t, ora,\n    annotation = bind_rows(rice_functions), \n    background = rownames(se_t),\n    min_setsize = 2, max_setsize = 1000\n)\n\n# Combining results\nrice_enrichment_all <- bind_rows(\n    bind_rows(ora_h, .id = \"Class\") |> mutate(group = \"Heading\"),\n    bind_rows(ora_t, .id = \"Class\") |> mutate(group = \"Tillering\")\n) |>\n    dplyr::select(class = Class, group, term, genes, all, padj)\n\n# Show results as an interactive table\nDT::datatable(\n    rice_enrichment_all,\n    selection = \"single\",\n    rownames = FALSE,\n    options = list(\n        lengthMenu = c(5, 10, 25, 50),\n        pageLength = 10\n    )\n) |>\n    DT::formatSignif(columns = \"padj\", digits = 3)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-2ae4f30d7598595affc4\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-2ae4f30d7598595affc4\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"UP\",\"DOWN\",\"DOWN\",\"DOWN\",\"DOWN\",\"DOWN\",\"DOWN\",\"DOWN\",\"DOWN\",\"DOWN\",\"DOWN\",\"DOWN\",\"DOWN\",\"DOWN\",\"DOWN\",\"DOWN\",\"ADD\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P1\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"DOWN\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\",\"ELD_P2\"],[\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Heading\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\",\"Tillering\"],[\"beta-glucan biosynthetic process\",\"beta-glucan metabolic process\",\"carbohydrate biosynthetic process\",\"cell wall assembly\",\"cell wall biogenesis\",\"Cell wall organisation.cellulose.cellulose-hemicellulose network assembly.regulatory protein (COB)\",\"cell wall organization\",\"cellular carbohydrate biosynthetic process\",\"cellular carbohydrate metabolic process\",\"cellular glucan metabolic process\",\"cellular polysaccharide biosynthetic process\",\"cellular polysaccharide metabolic process\",\"cellulose biosynthetic process\",\"cellulose metabolic process\",\"cellulose microfibril organization\",\"Cellulose synthase\",\"cellulose synthase (UDP-forming) activity\",\"cellulose synthase activity\",\"COBRA, plant\",\"Early nodulin 93 ENOD93 protein\",\"external encapsulating structure organization\",\"extracellular matrix organization\",\"generation of precursor metabolites and energy\",\"glucan biosynthetic process\",\"glucan metabolic process\",\"glucosyltransferase activity\",\"plant-type cell wall biogenesis\",\"plant-type cell wall organization or biogenesis\",\"polysaccharide biosynthetic process\",\"polysaccharide metabolic process\",\"response to anoxia\",\"UDP-glucosyltransferase activity\",\"cellular modified amino acid metabolic process\",\"flavone biosynthetic process\",\"flavone metabolic process\",\"flavonol biosynthetic process\",\"glutathione metabolic process\",\"Glutathione S-transferase Omega/Tau-like\",\"Glutathione S-transferase, C-terminal domain superfamily\",\"Glutathione S-transferase, N-terminal\",\"Glutathione S-transferases Tau, C-terminal alpha helical domain, plant\",\"glutathione transferase activity\",\"MYB-like transcription factor EOBI/EOBII-like, plant\",\"Redox homeostasis.glutathione-based redox regulation.glutathione S-transferase activities.class tau glutathione S-transferase\",\"RNA biosynthesis.transcriptional regulation.MYB  transcription factor superfamily.transcription factor (REVEILLE)\",\"SANT/Myb domain\",\"transferase activity, transferring alkyl or aryl (other than methyl) groups\",\"ADP binding\",\"ADP binding\",\"Aquaporin transporter\",\"Aquaporin-like\",\"channel activity\",\"defense response to bacterium\",\"Diacylglycerol kinase\",\"diacylglycerol kinase activity\",\"Diacylglycerol kinase, accessory domain\",\"Diacylglycerol kinase, plant\",\"Disease resistance protein, plants\",\"fluid transport\",\"inorganic ion homeostasis\",\"Lipid metabolism.glycerolipid biosynthesis.phosphatidate.diacylglycerol kinase\",\"Major intrinsic protein\",\"molecular transducer activity\",\"protein kinase C-activating G protein-coupled receptor signaling pathway\",\"response to bacterium\",\"response to hydrogen peroxide\",\"signaling receptor activity\",\"Solute transport.channels.MIP family.plasma membrane intrinsic protein (PIP)\",\"Solute-binding protein  family 3/N-terminal domain of MltF\",\"water channel activity\",\"water transmembrane transporter activity\",\"ADP binding\",\"Chlorophyll A-B binding protein\",\"Chlorophyll A-B binding protein, plant and chromista\",\"Chlorophyll a/b binding domain superfamily\",\"chlorophyll binding\",\"chloroplast thylakoid\",\"chloroplast thylakoid membrane\",\"Disease resistance protein, plants\",\"photosynthesis\",\"photosynthesis, light harvesting\",\"photosynthesis, light harvesting in photosystem I\",\"photosynthesis, light reaction\",\"photosynthetic membrane\",\"photosystem\",\"photosystem I\",\"photosystem I reaction center\",\"photosystem II\",\"plastid membrane\",\"plastid thylakoid\",\"plastid thylakoid membrane\",\"plastoglobule\",\"protein domain specific binding\",\"Rx, N-terminal\",\"thylakoid membrane\",\"CASP-like protein 1U\",\"ADP binding\",\"Apoptotic protease-activating factors, helical domain\",\"carbon-oxygen lyase activity, acting on phosphates\",\"Chlorophyll A-B binding protein\",\"chloroplast stroma\",\"chloroplast thylakoid\",\"chloroplast thylakoid membrane\",\"Disease resistance protein, plants\",\"diterpenoid biosynthetic process\",\"diterpenoid metabolic process\",\"gibberellin biosynthetic process\",\"gibberellin metabolic process\",\"isoprenoid biosynthetic process\",\"isoprenoid metabolic process\",\"NB-ARC\",\"photosynthesis\",\"plastid stroma\",\"plastid thylakoid\",\"plastid thylakoid membrane\",\"Rx, N-terminal\",\"terpene synthase activity\",\"Terpene synthase, N-terminal domain\",\"terpenoid biosynthetic process\",\"Terpenoid cyclases/protein prenyltransferase alpha-alpha toroid\",\"terpenoid metabolic process\",\"Virus X resistance protein-like, coiled-coil domain\",\"Winged helix-like DNA-binding domain superfamily\"],[5,5,11,3,9,3,9,8,10,8,7,9,5,5,3,3,3,3,3,4,9,3,9,7,8,6,8,10,8,9,4,5,8,3,3,3,8,6,6,6,6,8,3,6,3,6,9,10,40,9,9,20,58,5,5,5,4,34,9,26,5,9,20,5,66,14,20,5,6,9,9,17,4,4,4,4,20,20,16,16,5,5,9,21,14,10,4,8,20,20,20,9,11,13,20,3,21,13,6,4,28,18,15,22,9,9,6,6,14,14,17,13,28,18,15,15,6,5,14,6,14,12,16],[86,111,350,19,235,9,339,252,463,237,201,313,70,95,14,24,24,24,10,7,380,19,420,149,238,138,174,261,234,397,25,115,127,12,13,11,85,33,72,60,36,68,14,35,8,127,152,316,316,22,24,138,462,7,8,6,4,284,30,211,6,24,136,8,561,79,123,8,14,19,20,316,15,10,16,15,399,310,284,200,24,14,109,351,61,23,5,50,473,401,314,58,76,189,347,4,320,154,31,18,741,431,335,289,50,61,32,39,167,204,229,218,747,433,339,189,26,25,133,34,167,126,313],[0.01311731654563596,0.03512766056408715,0.0005520973203417959,0.02599345439958147,0.001091016521112611,0.005214964460480449,0.00638446371093247,0.006367671923947674,0.01023724169069624,0.00517529045754941,0.01023724169069624,0.00517529045754941,0.00658399042794143,0.01945938771231776,0.012732339327568,0.04516972807631885,0.04516972807631885,0.04516972807631885,0.006367671923947674,9.887600918510644e-05,0.01186527802107797,0.02599345439958147,0.02073663768411636,0.004291986329267787,0.00517529045754941,0.01175235617830664,0.001091016521112611,0.0005108681662359887,0.00517529045754941,0.01454499380266655,0.0048381168518024,0.04011950523635423,0.00026001729193129,0.02262736284360248,0.02630113218346718,0.01857565125686812,3.742646937270822e-05,3.742646937270822e-05,0.001519808993291912,0.0005731368396161525,3.904797212139539e-05,1.259487821564026e-05,0.02974972457237951,3.904797212139539e-05,0.007005246716933307,0.02630113218346718,8.345295102530159e-05,0.002277711206760363,0.001611189925206785,0.002331490131062034,0.003610096393341424,0.03637718203095482,2.115522034896831e-05,0.01005581944205975,0.01707395476149919,0.003610096393341424,0.01005581944205975,0.01309145993075297,0.01707395476149919,0.04864366989738893,0.003610096393341424,0.003610096393341424,0.03254970743962672,0.01707395476149919,2.115522034896831e-05,0.04864366989738893,0.01058722976385312,0.01707395476149919,0.03504075218539945,0.001004529535449332,0.0013036618317639,0.002818175499831343,0.02824921010922283,0.005874832040416614,0.03569266580476898,0.02824921010922283,0.00140896001431315,7.160669067040422e-05,0.002818175499831343,7.160669067040422e-05,0.01287417410137672,0.001136055493373424,0.01673350635870333,7.574504585308088e-05,1.788648735459653e-09,1.940970818698914e-09,0.0002663923761925083,0.0005994508035587103,0.01200586663045498,0.001412417550569328,7.160669067040422e-05,0.0002073086145177507,4.627383924474734e-05,0.002818175499831343,0.0002270711654942995,0.03531582888019705,2.332283914601056e-05,0.0003092076931811777,0.003119622121499985,0.04723060367536519,0.001897563997811363,0.02201404549308748,0.04114809959473207,1.821795928412446e-06,6.93617538166014e-05,0.0002332147385232009,0.003571701235144471,0.009593198939809701,0.0001605020290828286,0.00123153517428853,6.93617538166014e-05,0.008216527619418523,0.00206577901669496,0.02239913355060445,0.0451484897509393,0.0001544987147047144,0.001272880752563968,0.01278683680974875,2.332283914601056e-05,0.00489076848462615,0.0001605020290828286,0.000265357566779699,0.006271110686679438]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th>class<\\/th>\\n      <th>group<\\/th>\\n      <th>term<\\/th>\\n      <th>genes<\\/th>\\n      <th>all<\\/th>\\n      <th>padj<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"lengthMenu\":[5,10,25,50],\"pageLength\":10,\"columnDefs\":[{\"targets\":5,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"className\":\"dt-right\",\"targets\":[3,4,5]},{\"name\":\"class\",\"targets\":0},{\"name\":\"group\",\"targets\":1},{\"name\":\"term\",\"targets\":2},{\"name\":\"genes\",\"targets\":3},{\"name\":\"all\",\"targets\":4},{\"name\":\"padj\",\"targets\":5}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[\"options.columnDefs.0.render\"],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nIn summary, this is what we found for each class:\n\n1. **ADD:** a single term (ADP binding) at heading stage.\n\n2. **DOWN:** flavone biosynthesis, glutathione S-transferase,\nMYB transcription factors, CASP-like protein 1U at heading stage. At\ntillering stage, the only term was CASP-like protein 1U.\n\n3. **UP:** at the heading stage, genes were associated with\ncell wall organization, COBRA, early nodulins, response to anoxia,\nand beta-glucan biosynthesis. No terms were found at the tillering stage.\n\n4. **ELD_P1:** at the heading stage, genes were associated with\naquaporins, and diacylglycerol kinases. No terms were found at the tillering\nstage.\n\n5. **ELD_P2:** at the heading and tillering stages, genes were associated with\nphotosynthesis. There were also tillering stage-specific terms, including\napoptose-activating factors, gibberellin biosynthesis, terpene synthases, \nand isoprenoid biosynthesis.\n\n\n## Saving important objects {.unnumbered}\n\nLastly, we will save important objects to files, so that they can be reused \nlater.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plots\np_freq_combined_b2 <- p_freq_combined\nsave(\n    p_freq_combined_b2, compress = \"xz\",\n    file = here(\"products\", \"plots\", \"p_freq_combined_b2.rda\")\n)\n\np_upset_b2 <- p_upset\nsave(\n    p_upset_b2, compress = \"xz\",\n    file = here(\"products\", \"plots\", \"p_upset_b2.rda\")\n)\n\np_pca_b2 <- p_pca_combined\nsave(\n    p_pca_b2, compress = \"xz\",\n    file = here(\"products\", \"plots\", \"p_pca_b2.rda\")\n)\n\np_triangle_b2 <- p_triangle_all\nsave(\n    p_triangle_b2, compress = \"xz\",\n    file = here(\"products\", \"plots\", \"p_triangle_b2.rda\")\n)\n\n# Objects\npartition_tables_b2 <- list(\n    Heading = partition_h,\n    Tillering = partition_t\n)\n\nsave(\n    partition_tables_b2, compress = \"xz\",\n    file = here(\"products\", \"result_files\", \"partition_tables_b2.rda\")\n)\n\nsave(\n    rice_enrichment_all, compress = \"xz\",\n    file = here(\"products\", \"result_files\", \"rice_enrichment_all.rda\")\n)\n```\n:::\n\n\n\n## Session info {.unnumbered}\n\nThis document was created under the following conditions:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.3.2 (2023-10-31)\n os       Ubuntu 22.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  en_US.UTF-8\n ctype    en_US.UTF-8\n tz       Europe/Brussels\n date     2024-03-28\n pandoc   3.1.1 @ /usr/lib/rstudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package              * version   date (UTC) lib source\n abind                  1.4-5     2016-07-21 [1] CRAN (R 4.3.2)\n Biobase              * 2.62.0    2023-10-24 [1] Bioconductor\n BiocGenerics         * 0.48.1    2023-11-01 [1] Bioconductor\n BiocParallel           1.37.0    2024-01-19 [1] Github (Bioconductor/BiocParallel@79a1b2d)\n bitops                 1.0-7     2021-04-24 [1] CRAN (R 4.3.2)\n bslib                  0.6.1     2023-11-28 [1] CRAN (R 4.3.2)\n cachem                 1.0.8     2023-05-01 [1] CRAN (R 4.3.2)\n Cairo                  1.6-2     2023-11-28 [1] CRAN (R 4.3.2)\n circlize               0.4.15    2022-05-10 [1] CRAN (R 4.3.2)\n cli                    3.6.2     2023-12-11 [1] CRAN (R 4.3.2)\n clue                   0.3-65    2023-09-23 [1] CRAN (R 4.3.2)\n cluster                2.1.5     2023-11-27 [4] CRAN (R 4.3.2)\n codetools              0.2-19    2023-02-01 [4] CRAN (R 4.2.2)\n colorspace             2.1-0     2023-01-23 [1] CRAN (R 4.3.2)\n ComplexHeatmap       * 2.18.0    2023-10-24 [1] Bioconductor\n crayon                 1.5.2     2022-09-29 [1] CRAN (R 4.3.2)\n crosstalk              1.2.1     2023-11-23 [1] CRAN (R 4.3.2)\n DelayedArray           0.28.0    2023-10-24 [1] Bioconductor\n DESeq2                 1.42.0    2023-10-24 [1] Bioconductor\n digest                 0.6.34    2024-01-11 [1] CRAN (R 4.3.2)\n doParallel             1.0.17    2022-02-07 [1] CRAN (R 4.3.2)\n dplyr                * 1.1.4     2023-11-17 [1] CRAN (R 4.3.2)\n DT                     0.31      2023-12-09 [1] CRAN (R 4.3.2)\n ellipsis               0.3.2     2021-04-29 [1] CRAN (R 4.3.2)\n evaluate               0.23      2023-11-01 [1] CRAN (R 4.3.2)\n fansi                  1.0.6     2023-12-08 [1] CRAN (R 4.3.2)\n farver                 2.1.1     2022-07-06 [1] CRAN (R 4.3.2)\n fastmap                1.1.1     2023-02-24 [1] CRAN (R 4.3.2)\n forcats              * 1.0.0     2023-01-29 [1] CRAN (R 4.3.2)\n foreach                1.5.2     2022-02-02 [1] CRAN (R 4.3.2)\n fs                     1.6.3     2023-07-20 [1] CRAN (R 4.3.2)\n generics               0.1.3     2022-07-05 [1] CRAN (R 4.3.2)\n GenomeInfoDb         * 1.38.6    2024-02-08 [1] Bioconductor 3.18 (R 4.3.2)\n GenomeInfoDbData       1.2.11    2023-12-21 [1] Bioconductor\n GenomicRanges        * 1.54.1    2023-10-29 [1] Bioconductor\n GetoptLong             1.0.5     2020-12-15 [1] CRAN (R 4.3.2)\n ggplot2              * 3.5.0     2024-02-23 [1] CRAN (R 4.3.2)\n ggplotify              0.1.2     2023-08-09 [1] CRAN (R 4.3.2)\n ggsci                  3.0.0     2023-03-08 [1] CRAN (R 4.3.2)\n GlobalOptions          0.1.2     2020-06-10 [1] CRAN (R 4.3.2)\n glue                   1.7.0     2024-01-09 [1] CRAN (R 4.3.2)\n gridGraphics           0.5-1     2020-12-13 [1] CRAN (R 4.3.2)\n gtable                 0.3.4     2023-08-21 [1] CRAN (R 4.3.2)\n here                 * 1.0.1     2020-12-13 [1] CRAN (R 4.3.2)\n hms                    1.1.3     2023-03-21 [1] CRAN (R 4.3.2)\n htmltools              0.5.7     2023-11-03 [1] CRAN (R 4.3.2)\n htmlwidgets            1.6.4     2023-12-06 [1] CRAN (R 4.3.2)\n HybridExpress        * 0.99.0    2024-02-15 [1] Bioconductor\n IRanges              * 2.36.0    2023-10-24 [1] Bioconductor\n iterators              1.0.14    2022-02-05 [1] CRAN (R 4.3.2)\n jquerylib              0.1.4     2021-04-26 [1] CRAN (R 4.3.2)\n jsonlite               1.8.8     2023-12-04 [1] CRAN (R 4.3.2)\n knitr                  1.45      2023-10-30 [1] CRAN (R 4.3.2)\n labeling               0.4.3     2023-08-29 [1] CRAN (R 4.3.2)\n lattice                0.22-5    2023-10-24 [4] CRAN (R 4.3.1)\n lifecycle              1.0.4     2023-11-07 [1] CRAN (R 4.3.2)\n locfit                 1.5-9.8   2023-06-11 [1] CRAN (R 4.3.2)\n lubridate            * 1.9.3     2023-09-27 [1] CRAN (R 4.3.2)\n magick                 2.8.2     2023-12-20 [1] CRAN (R 4.3.2)\n magrittr               2.0.3     2022-03-30 [1] CRAN (R 4.3.2)\n Matrix                 1.6-3     2023-11-14 [4] CRAN (R 4.3.2)\n MatrixGenerics       * 1.14.0    2023-10-24 [1] Bioconductor\n matrixStats          * 1.2.0     2023-12-11 [1] CRAN (R 4.3.2)\n memoise                2.0.1     2021-11-26 [1] CRAN (R 4.3.2)\n munsell                0.5.0     2018-06-12 [1] CRAN (R 4.3.2)\n patchwork            * 1.2.0     2024-01-08 [1] CRAN (R 4.3.2)\n pillar                 1.9.0     2023-03-22 [1] CRAN (R 4.3.2)\n pkgconfig              2.0.3     2019-09-22 [1] CRAN (R 4.3.2)\n png                    0.1-8     2022-11-29 [1] CRAN (R 4.3.2)\n purrr                * 1.0.2     2023-08-10 [1] CRAN (R 4.3.2)\n R6                     2.5.1     2021-08-19 [1] CRAN (R 4.3.2)\n RColorBrewer           1.1-3     2022-04-03 [1] CRAN (R 4.3.2)\n Rcpp                   1.0.12    2024-01-09 [1] CRAN (R 4.3.2)\n RCurl                  1.98-1.14 2024-01-09 [1] CRAN (R 4.3.2)\n readr                * 2.1.5     2024-01-10 [1] CRAN (R 4.3.2)\n rjson                  0.2.21    2022-01-09 [1] CRAN (R 4.3.2)\n rlang                  1.1.3     2024-01-10 [1] CRAN (R 4.3.2)\n rmarkdown              2.25      2023-09-18 [1] CRAN (R 4.3.2)\n rprojroot              2.0.4     2023-11-05 [1] CRAN (R 4.3.2)\n rstudioapi             0.15.0    2023-07-07 [1] CRAN (R 4.3.2)\n S4Arrays               1.2.0     2023-10-24 [1] Bioconductor\n S4Vectors            * 0.40.2    2023-11-23 [1] Bioconductor 3.18 (R 4.3.2)\n sass                   0.4.8     2023-12-06 [1] CRAN (R 4.3.2)\n scales                 1.3.0     2023-11-28 [1] CRAN (R 4.3.2)\n sessioninfo            1.2.2     2021-12-06 [1] CRAN (R 4.3.2)\n shape                  1.4.6     2021-05-19 [1] CRAN (R 4.3.2)\n SparseArray            1.2.4     2024-02-11 [1] Bioconductor 3.18 (R 4.3.2)\n stringi                1.8.3     2023-12-11 [1] CRAN (R 4.3.2)\n stringr              * 1.5.1     2023-11-14 [1] CRAN (R 4.3.2)\n SummarizedExperiment * 1.32.0    2023-10-24 [1] Bioconductor\n tibble               * 3.2.1     2023-03-20 [1] CRAN (R 4.3.2)\n tidyr                * 1.3.1     2024-01-24 [1] CRAN (R 4.3.2)\n tidyselect             1.2.0     2022-10-10 [1] CRAN (R 4.3.2)\n tidyverse            * 2.0.0     2023-02-22 [1] CRAN (R 4.3.2)\n timechange             0.3.0     2024-01-18 [1] CRAN (R 4.3.2)\n tzdb                   0.4.0     2023-05-12 [1] CRAN (R 4.3.2)\n utf8                   1.2.4     2023-10-22 [1] CRAN (R 4.3.2)\n vctrs                  0.6.5     2023-12-01 [1] CRAN (R 4.3.2)\n withr                  3.0.0     2024-01-16 [1] CRAN (R 4.3.2)\n xfun                   0.42      2024-02-08 [1] CRAN (R 4.3.2)\n XVector                0.42.0    2023-10-24 [1] Bioconductor\n yaml                   2.3.8     2023-12-11 [1] CRAN (R 4.3.2)\n yulab.utils            0.1.4     2024-01-28 [1] CRAN (R 4.3.2)\n zlibbioc               1.48.0    2023-10-24 [1] Bioconductor\n\n [1] /home/faalm/R/x86_64-pc-linux-gnu-library/4.3\n [2] /usr/local/lib/R/site-library\n [3] /usr/lib/R/site-library\n [4] /usr/lib/R/library\n\n──────────────────────────────────────────────────────────────────────────────\n```\n\n\n:::\n:::\n\n\n## References {.unnumbered}\n",
    "supporting": [
      "chapter_02_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.31/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}